mw.loader.implement("ext.visualEditor.wikiaViewPageTarget.init",function($){(function(){var conf,tabMessages,uri,pageExists,viewUri,veEditUri,viewPage,init,support,getTargetDeferred,vePreferred,browserSupported,plugins=[],trackerConfig={'category':'editor-ve','trackingMethod':'both'},spinnerTimeoutId=null;function getOptimizelyExperimentId(experimentName){if(experimentName==='VE Source Entry Point Anon'){return mw.config.get('wgDevelEnvironment')?1673650053:1783530197;}else if(experimentName==='VE Source Entry Point User'){return mw.config.get('wgDevelEnvironment')?1673650053:1779071141;}return null;}function initSpinner(){var $spinner=$('<div>').addClass('ve-spinner visible').attr('data-type','loading'),$content=$('<div>').addClass('content'),$icon=$('<div>').addClass('loading'),$message=$('<p>').addClass('message').text(mw.message('wikia-visualeditor-loading').plain());$content.append($icon).append($message);$spinner.append($content).appendTo($('body')).css('opacity',1).hide();mw.
hook('ve.activationComplete').add(function hide(){if(spinnerTimeoutId){clearTimeout(spinnerTimeoutId);spinnerTimeoutId=null;}});}function showSpinner(){var $spinner=$('.ve-spinner[data-type="loading"]'),$message=$spinner.find('p.message');$message.hide();$spinner.fadeIn(400);spinnerTimeoutId=setTimeout(function(){if($spinner.is(':visible')){$message.slideDown(400);}},3000);}initSpinner();function getTarget(){var loadTargetDeferred;window.optimizely=window.optimizely||[];if(mw.user.anonymous()){window.optimizely.push(['activate',getOptimizelyExperimentId('VE Source Entry Point Anon')]);}else{window.optimizely.push(['activate',getOptimizelyExperimentId('VE Source Entry Point User')]);}showSpinner();Wikia.Tracker.track(trackerConfig,{'action':Wikia.Tracker.ACTIONS.IMPRESSION,'label':'edit-page'});window.gaTrackPageview('/fake-visual-editor/edit-page/impression','ve');if(!getTargetDeferred){getTargetDeferred=$.Deferred();loadTargetDeferred=$.Deferred();$.when(loadTargetDeferred,$.
getResources($.getSassCommonURL('/extensions/VisualEditor/wikia/VisualEditor.scss'))).done(function(){var target=new ve.init.mw.WikiaViewPageTarget();ve.init.mw.WikiaViewPageTarget.prototype.setupSectionEditLinks=init.setupSectionLinks;target.addPlugins(plugins);getTargetDeferred.resolve(target);}).fail(getTargetDeferred.reject);mw.loader.using('ext.visualEditor.wikiaViewPageTarget',loadTargetDeferred.resolve,loadTargetDeferred.reject);}return getTargetDeferred.promise();}conf=mw.config.get('wgVisualEditorConfig');tabMessages=conf.tabMessages;uri=new mw.Uri(location.href);pageExists=!!mw.config.get('wgArticleId')||mw.config.get('wgNamespaceNumber')<0;viewUri=new mw.Uri(mw.util.getUrl(mw.config.get('wgRelevantPageName')));veEditUri=viewUri.clone().extend({'veaction':'edit'});viewPage=(mw.config.get('wgIsArticle')&&!('diff'in uri.query));vePreferred=!!mw.config.get('wgVisualEditorPreferred');support={es5:!!(Array.isArray&&Array.prototype.filter&&Array.prototype.indexOf&&Array.prototype.
map&&Date.now&&Date.prototype.toJSON&&Object.create&&Object.keys&&String.prototype.trim&&window.JSON&&JSON.parse&&JSON.stringify),contentEditable:'contentEditable'in document.createElement('div'),svg:!!(document.createElementNS&&document.createElementNS('http://www.w3.org/2000/svg','svg').createSVGRect)};init={activateOnPageLoad:uri.query.veaction==='edit',support:support,blacklist:conf.blacklist,addPlugin:function(plugin){plugins.push(plugin);},setupTabs:function(){$('#ca-ve-edit').click(init.onEditTabClick);},setupSectionLinks:function(){$('#mw-content-text').find('.editsection a').click(init.onEditSectionLinkClick);},onEditTabClick:function(e){if((e.which&&e.which!==1)||e.shiftKey||e.altKey||e.ctrlKey||e.metaKey){if(window.veTrack){veTrack({action:'ve-edit-page-ignored',trigger:'onEditTabClick'});}return;}e.preventDefault();Wikia.Tracker.track(trackerConfig,{'action':Wikia.Tracker.ACTIONS.CLICK,'category':'article','label':'ve-edit'});if(window.veTrack){veTrack({action:
've-edit-page-start',trigger:'onEditTabClick'});}getTarget().done(function(target){target.activate();});},onEditSectionLinkClick:function(e){if((e.which&&e.which!==1)||e.shiftKey||e.altKey||e.ctrlKey||e.metaKey){if(window.veTrack){veTrack({action:'ve-edit-page-ignored',trigger:'onEditTabClick'});}return;}e.preventDefault();Wikia.Tracker.track(trackerConfig,{'action':Wikia.Tracker.ACTIONS.CLICK,'category':'article','label':'ve-section-edit'});if(window.veTrack){veTrack({action:'ve-edit-page-start',trigger:'onEditSectionLinkClick'});}getTarget().done(function(target){target.saveEditSection($(e.target).closest('h1, h2, h3, h4, h5, h6').get(0));target.activate();});}};browserSupported=support.es5&&support.contentEditable&&(('vewhitelist'in uri.query)||!$.client.test(init.blacklist,null,true));init.isInValidNamespace=function(article){return $.inArray(new mw.Title(article).getNamespaceId(),conf.namespaces)!==-1;};init.canCreatePageUsingVE=function(){return browserSupported&&vePreferred;};
window.mw.libs.ve=init;function setupRedlinks(){$(document).on('mouseover click','a[href*="action=edit"][href*="&redlink"]:not([href*="veaction=edit"])',function(){var $element=$(this),href=$element.attr('href'),articlePath=mw.config.get('wgArticlePath').replace('$1',''),redlinkArticle=new mw.Uri(href).path.replace(articlePath,'');if(init.isInValidNamespace(decodeURIComponent(redlinkArticle))){$element.attr('href',href.replace('action=edit','veaction=edit'));}});}function removeVELink(){var $edit=$('#ca-edit'),$veEdit=$('#ca-ve-edit');$('html').addClass('ve-not-available');if(vePreferred&&$veEdit.length>0){$veEdit.attr('href',$edit.attr('href'));$edit.parent().remove();}else{$veEdit.parent().remove();}}if(browserSupported){if(viewPage&&init.isInValidNamespace(mw.config.get('wgRelevantPageName'))){$(function(){if(init.activateOnPageLoad){if(window.veTrack){veTrack({action:'ve-edit-page-start',trigger:'activateOnPageLoad'});}getTarget().done(function(target){target.activate();});}init.
setupTabs();if(vePreferred){init.setupSectionLinks();}});}else{removeVELink();}if(vePreferred){$(setupRedlinks);}}else{removeVELink();}}());;},{},{"wikia-visualeditor-loading":"Loading the VisualEditor..."});

/* cache key: totalfreedomminecraftserver:resourceloader:filter:minify-js:7:c84b12c265100d78aee6b854af0c64eb */